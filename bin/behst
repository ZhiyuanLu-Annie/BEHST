#!/usr/bin/python2.7

# To run this script:
#
# ./behst.py ../data/pressto_LUNG_enhancers.bed dataFolderName


import argparse
import subprocess

from time import sleep
from datetime import datetime
start_time = datetime.now()


INPUT_FILE="unknown"
BEHST_DATA_FOLDER="~/.local/share/behst"
TSS_EXT="default_et"
QUERY_AC="default_eq"
GENE_ANNOTATION_FILE="default_gene_annotation_file"
TRANSCRIPT_ANNOTATION_FILE="default_transcript_annotation_file"
HI_C_FILE="default_long_range_interaction_file"


citation = "Citation: Chicco D, Bi HS, Reimand J, Hoffman MM. 2017. \"BEHST: Genomic set enrichment analysis enhanced through integration of chromatin long-range interactions\". In preparation."
parser = argparse.ArgumentParser(epilog=citation)


parser.add_argument("BEDFILE", help="path to query genomic region file (BED format) regions")

parser.add_argument("-T", "--target-extension", metavar='BP', help="extend target regions by BP base pairs (default 9400)\n", action="store")
parser.add_argument("-Q", "--query-extension", metavar='BP', help="extend query regions by BP base pairs (default 24100)\n", action="store")
parser.add_argument("-d", "--data", metavar="DATADIR", help="path to directory with reference data (default ~/.local/share/behst)")
parser.add_argument("-g", "--gene-annotation-file", metavar='FILE', help="path of gene annotation file (GTF format, default DATADIR/gencode.v19.annotation_withproteinids.gtf).\n", action="store")
parser.add_argument("-t", "--transcript-file", metavar='FILE', help="path to the principal transcript file (BED format, default DATADIR/appris_data_principal.bed)\n\n", action="store")
parser.add_argument("-i", "--interaction-file", metavar='FILE', help="path to the chromatin interactions file (HICCUPS Format, default DATADIR/hic_8celltypes.hiccups).\n\n", action="store")

parser.add_argument("-v", "--version", help="print current BEHST version\n", action="version", version='%(prog)s (version 1.5)')



args = parser.parse_args()
print args


INPUT_FILE = args.BEDFILE
BEHST_DATA_FOLDER = args.DATADIR

if args.target_extension:
  TSS_EXT = args.target_extension

if args.query_extension:
  QUERY_AC = args.query_extension

if args.gene_annotation_file:
  GENE_ANNOTATION_FILE = args.gene_annotation_file

if args.transcript_file:
  TRANSCRIPT_ANNOTATION_FILE = args.transcript_file

if args.interaction_file:
  HI_C_FILE = args.interaction_file
  

print "INPUT_FILE: ",INPUT_FILE
print "BEHST_DATA_FOLDER: ",BEHST_DATA_FOLDER
print "TSS_EXT: ",TSS_EXT
print "QUERY_AC: ",QUERY_AC
print "GENE_ANNOTATION_FILE: ",GENE_ANNOTATION_FILE
print "TRANSCRIPT_ANNOTATION_FILE: ",TRANSCRIPT_ANNOTATION_FILE
print "HI_C_FILE: ",HI_C_FILE

# subprocess.call(['./project.sh', INPUT_FILE, BEHST_DATA_FOLDER, QUERY_AC, TSS_EXT, GENE_ANNOTATION_FILE, TRANSCRIPT_ANNOTATION_FILE, HI_C_FILE])
# $PREFIX/bin

subprocess.call(['/usr/bin/env', 'bash', 'project.sh', INPUT_FILE, BEHST_DATA_FOLDER, QUERY_AC, TSS_EXT, GENE_ANNOTATION_FILE, TRANSCRIPT_ANNOTATION_FILE, HI_C_FILE])
